<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MUSICAL CALCULATOR</title>
    <script src="https://chonggi-tokhu.github.io/files/kin_choice/new/ColourgreyShorterCSSJS-0.0.1.js"></script>
    <script src="./player.js"></script>
    <script src="./musical-calculator.js"></script>
    <style>
        .musical-calculator {
            height: 14em;
            background: silver;
            width: fit-content;
            padding: 0.5rem;
            border-radius: 6%;
            box-shadow: 2px 2px 1px 1px #000000, -2px -2px 1px 1px #000000, 2px -2px 1px 1px #000000, -2px 2px 1px 1px #000000;
        }

        .musical-calculator tr td {
            margin: 0.5rem;
            border-radius: 8vmax;
        }

        .musical-calculator>div>div>div {
            height: 1em;
            margin: 0.1rem;
            margin-top: 0.5em;
            min-width: 2rem;
        }

        .musical-calculator>div>div>div>span {
            border: 1px solid #000000;
            border-radius: 8vmax;
            min-width: 2rem;
            display: block;
            margin-top: 0.5em;
            text-align: center;
        }

        .calculators {
            display: flex;
        }

        .calculators .musical-calculator {
            margin-left: 1rem;
            margin-top: 1em;
        }
    </style>
</head>

<body>
    <div class="body">
        <div class="calculators">
            <!-- <table class="musical-calculator">
            <tbody>
                <tr>
                    <td colspan="10" rowspan="2">
                        <div contenteditable="true" style="background: #1c873c;color:#000000">1972-11-21</div>
                    </td>
                </tr>
                <tr>
                    <td colspan="2" rowspan="2"><span style="background: lightgrey;color:#222222;">O</span></td>
                    <td colspan="2"><span style="background: black;color:white;">音量</span></td>
                    <td colspan="2"><span style="background: black;color:white;">時間</span></td>
                    <td colspan="2"><span style="background: black;color:white;">鬧鈴</span></td>
                    <td colspan="2"><span style="background: darkred;color:white;">AC</span></td>
                </tr>
                <tr>
                    <td colspan="2"><span style="background: blue;color:white;">M+</span></td>
                    <td colspan="2"><span style="background: blue;color:white;">M-</span></td>
                    <td colspan="2"><span style="background: blue;color:white;">MRC</span></td>
                    <td colspan="2"><span style="background: darkred;color:white;">CE</span></td>
                </tr>
                <tr>
                    <td colspan="2" rowspan="2"><span style="background: black;color:white;">7</span></td>
                    <td colspan="2" rowspan="2"><span style="background: black;color:white;">8</span></td>
                    <td colspan="2" rowspan="2"><span style="background: black;color:white;">9</span></td>
                    <td colspan="2" rowspan="2"><span style="background: white;color:black;">GT</span></td>
                    <td colspan="2" rowspan="2"><span style="background: white;color:black;">→</span></td>
                </tr>
                <tr>
                    <td colspan="2" rowspan="2"><span style="background: black;color:white;">4</span></td>
                    <td colspan="2" rowspan="2"><span style="background: black;color:white;">5</span></td>
                    <td colspan="2" rowspan="2"><span style="background: black;color:white;">6</span></td>
                    <td colspan="2" rowspan="2"><span style="background: white;color:black;">×</span></td>
                    <td colspan="2" rowspan="2"><span style="background: white;color:black;">÷</span></td>
                </tr>
                <tr>
                    <td colspan="2" rowspan="2"><span style="background: black;color:white;">1</span></td>
                    <td colspan="2" rowspan="2"><span style="background: black;color:white;">2</span></td>
                    <td colspan="2" rowspan="2"><span style="background: black;color:white;">3</span></td>
                    <td colspan="2" rowspan="4"><span style="background: white;color:black;">+</span></td>
                    <td colspan="2" rowspan="2"><span style="background: white;color:black;">-</span></td>
                </tr>
                <tr>
                    <td colspan="2" rowspan="2"><span style="background: black;color:white;">0</span></td>
                    <td colspan="2" rowspan="2"><span style="background: black;color:white;">00</span></td>
                    <td colspan="2" rowspan="2"><span style="background: black;color:white;">.</span></td>
                    <td colspan="2" rowspan="2"><span style="background: white;color:black;">=</span></td>
                </tr>
            </tbody>
        </table> -->
            <div class="musical-calculator" id="musical-calculator-left" tabindex="0">
                <div>
                    <div style="display: flex;">
                        <div contenteditable="true"
                            style="background: #1c873c;color:#000000;width: 100%;height: 1.5em;margin-left: 0.5rem;margin-right: 0.5rem;">
                            1972-11-21</div>
                    </div>
                    <div style="display: flex;">
                        <div class="calc-button" style="height: 2em;"><span
                                style="background: lightgrey;color:#222222;height: 2.4em;display: block;width: 2rem;">O</span>
                        </div>
                        <div class="calc-button"><span style="background: black;color:white;">音量</span></div>
                        <div class="calc-button"><span style="background: black;color:white;">時間</span></div>
                        <div class="calc-button"><span style="background: black;color:white;">鬧鈴</span></div>
                        <div class="calc-button"><span style="background: darkred;color:white;">AC</span></div>
                    </div>
                    <div style="display:flex;position: relative;left: 2.2rem;">
                        <div class="calc-button"><span style="background: blue;color:white;">M+</span></div>
                        <div class="calc-button"><span style="background: blue;color:white;">M-</span></div>
                        <div class="calc-button"><span style="background: blue;color:white;">MRC</span></div>
                        <div class="calc-button"><span style="background: darkred;color:white;"
                                data-button-key="CE">CE</span></div>
                    </div>
                    <div style="display:flex;">
                        <div class="calc-button"><span style="background: black;color:white;" data-button-name="B4"
                                data-button-idx="6" data-button-key="7">7</span>
                        </div>
                        <div class="calc-button"><span style="background: black;color:white;" data-button-name="C5"
                                data-button-idx="7" data-button-key="8">8</span>
                        </div>
                        <div class="calc-button"><span style="background: black;color:white;" data-button-name="D5"
                                data-button-idx="8" data-button-key="9">9</span>
                        </div>
                        <div class="calc-button"><span style="background: white;color:black;">GT</span></div>
                        <div class="calc-button"><span style="background: white;color:black;">→</span></div>
                    </div>
                    <div style="display:flex;">
                        <div class="calc-button"><span style="background: black;color:white;" data-button-name="F4"
                                data-button-idx="3" data-button-key="4">4</span>
                        </div>
                        <div class="calc-button"><span style="background: black;color:white;" data-button-name="G4"
                                data-button-idx="4" data-button-key="5">5</span>
                        </div>
                        <div class="calc-button"><span style="background: black;color:white;" data-button-name="A4"
                                data-button-idx="5" data-button-key="6">6</span>
                        </div>
                        <div class="calc-button"><span style="background: white;color:black;" data-button-name="G5"
                                data-button-idx="11" data-button-key="*">×</span>
                        </div>
                        <div class="calc-button"><span style="background: white;color:black;" data-button-name="A5"
                                data-button-idx="12" data-button-key="/">÷</span>
                        </div>
                    </div>
                    <div style="display:flex;">
                        <div class="calc-button"><span style="background: black;color:white;" data-button-name="C4"
                                data-button-idx="0" data-button-key="1">1</span>
                        </div>
                        <div class="calc-button"><span style="background: black;color:white;" data-button-name="D4"
                                data-button-idx="1" data-button-key="2">2</span>
                        </div>
                        <div class="calc-button"><span style="background: black;color:white;" data-button-name="E6"
                                data-button-idx="2" data-button-key="3">3</span>
                        </div>
                        <div class="calc-button"><span
                                style="background: white;color:black;position: absolute;height: 3em;"
                                data-button-name="E5" data-button-idx="9" data-button-key="+">+</span></div>
                        <div class="calc-button"><span style="background: white;color:black;" data-button-name="F5"
                                data-button-idx="10" data-button-key="-">-</span>
                        </div>
                    </div>
                    <div style="display:flex;">
                        <div class="calc-button"><span style="background: black;color:white;"
                                data-button-key="0">0</span>
                        </div>
                        <div class="calc-button"><span style="background: black;color:white;"
                                data-button-key="00">00</span>
                        </div>
                        <div class="calc-button"><span style="background: black;color:white;"
                                data-button-key=".">.</span>
                        </div>
                        <div class="calc-button">__</div>
                        <div class="calc-button"><span style="background: white;color:black;" data-button-name="B5"
                                data-button-idx="13" data-button-key="=">=</span>
                        </div>
                    </div>
                </div>
            </div>
            <div class="musical-calculator" id="musical-calculator-right" tabindex="1">
                <div>
                    <div style="display: flex;">
                        <div contenteditable="true"
                            style="background: #1c873c;color:#000000;width: 100%;height: 1.5em;margin-left: 0.5rem;margin-right: 0.5rem;">
                            1972-11-21</div>
                    </div>
                    <div style="display: flex;">
                        <div class="calc-button" style="height: 2em;"><span
                                style="background: lightgrey;color:#222222;height: 2.4em;display: block;width: 2rem;">O</span>
                        </div>
                        <div class="calc-button"><span style="background: black;color:white;">音量</span></div>
                        <div class="calc-button"><span style="background: black;color:white;">時間</span></div>
                        <div class="calc-button"><span style="background: black;color:white;">鬧鈴</span></div>
                        <div class="calc-button"><span style="background: darkred;color:white;">AC</span></div>
                    </div>
                    <div style="display:flex;position: relative;left: 2.2rem;">
                        <div class="calc-button"><span style="background: blue;color:white;">M+</span></div>
                        <div class="calc-button"><span style="background: blue;color:white;">M-</span></div>
                        <div class="calc-button"><span style="background: blue;color:white;">MRC</span></div>
                        <div class="calc-button"><span style="background: darkred;color:white;"
                                data-button-key="CE">CE</span></div>
                    </div>
                    <div style="display:flex;">
                        <div class="calc-button"><span style="background: black;color:white;" data-button-name="B4"
                                data-button-idx="6" data-button-key="7">7</span>
                        </div>
                        <div class="calc-button"><span style="background: black;color:white;" data-button-name="C5"
                                data-button-idx="7" data-button-key="8">8</span>
                        </div>
                        <div class="calc-button"><span style="background: black;color:white;" data-button-name="D5"
                                data-button-idx="8" data-button-key="9">9</span>
                        </div>
                        <div class="calc-button"><span style="background: white;color:black;">GT</span></div>
                        <div class="calc-button"><span style="background: white;color:black;">→</span></div>
                    </div>
                    <div style="display:flex;">
                        <div class="calc-button"><span style="background: black;color:white;" data-button-name="F4"
                                data-button-idx="3" data-button-key="4">4</span>
                        </div>
                        <div class="calc-button"><span style="background: black;color:white;" data-button-name="G4"
                                data-button-idx="4" data-button-key="5">5</span>
                        </div>
                        <div class="calc-button"><span style="background: black;color:white;" data-button-name="A4"
                                data-button-idx="5" data-button-key="6">6</span>
                        </div>
                        <div class="calc-button"><span style="background: white;color:black;" data-button-name="G5"
                                data-button-idx="11" data-button-key="*">×</span>
                        </div>
                        <div class="calc-button"><span style="background: white;color:black;" data-button-name="A5"
                                data-button-idx="12" data-button-key="/">÷</span>
                        </div>
                    </div>
                    <div style="display:flex;">
                        <div class="calc-button"><span style="background: black;color:white;" data-button-name="C4"
                                data-button-idx="0" data-button-key="1">1</span>
                        </div>
                        <div class="calc-button"><span style="background: black;color:white;" data-button-name="D4"
                                data-button-idx="1" data-button-key="2">2</span>
                        </div>
                        <div class="calc-button"><span style="background: black;color:white;" data-button-name="E6"
                                data-button-idx="2" data-button-key="3">3</span>
                        </div>
                        <div class="calc-button"><span
                                style="background: white;color:black;position: absolute;height: 3em;"
                                data-button-name="E5" data-button-idx="9" data-button-key="+">+</span></div>
                        <div class="calc-button"><span style="background: white;color:black;" data-button-name="F5"
                                data-button-idx="10" data-button-key="-">-</span>
                        </div>
                    </div>
                    <div style="display:flex;">
                        <div class="calc-button"><span style="background: black;color:white;"
                                data-button-key="0">0</span>
                        </div>
                        <div class="calc-button"><span style="background: black;color:white;"
                                data-button-key="00">00</span>
                        </div>
                        <div class="calc-button"><span style="background: black;color:white;"
                                data-button-key=".">.</span>
                        </div>
                        <div class="calc-button">__</div>
                        <div class="calc-button"><span style="background: white;color:black;" data-button-name="B5"
                                data-button-idx="13" data-button-key="=">=</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div>
            <p>
            <h3>주의: 이 계산기는 계산을 할 수 없습니다. <span style="color:grey;text-decoration: line-through;">근데 정작 계산기 기능 구현보다 악기 기능
                    구현이 더 어려움</span></h3>
            </p>
            <p>
            <h3>설명서:</h3>
            </p>
            <p>

                <span>1 2 3 4 5 6 7 8 9 + - × ÷ 순서로 C3부터 D3, E4, F4... 순서로 올라갑니다.</span>
            </p>
            <p>
                <span> 오른쪽 계산기는 q w e r t y u i o p a s d f 순서로 C#3부터 D#3, F4, F#4, G#3... 순서로 올라갑니다.</span>
            </p>
        </div>
    </div>
    <script>
        var ColourgreyShorterJS = window['ColourgreyShorterJS'];
        var cgrcssjs = new ColourgreyShorterJS.ColourgreyShorterCSS(false);
        document.addEventListener("DOMContentLoaded", (ev) => {
            cgrcssjs.styleAll();
        });
        var AR7778 = window['AR7778'];
        var calculator = new AR7778({ length: 2, semitone_up: false });
        var calculator_right = new AR7778({ length: 2, semitone_up: true });
        calculator.init((inst) => {
            document.querySelectorAll(`#musical-calculator-left .calc-button span`).forEach((el, idx, parel) => {
                el.addEventListener("click", (ev) => {
                    console.log(el.getAttribute("data-button-idx"));
                    calculator.playButton(Number(el.getAttribute("data-button-idx")));
                });
                console.log(el);
            });

        });
        calculator_right.init((inst) => {

            document.querySelectorAll(`#musical-calculator-right .calc-button span`).forEach((el, idx, parel) => {
                el.addEventListener("click", (ev) => {
                    console.log(el.getAttribute("data-button-idx"));
                    calculator_right.playButton(Number(el.getAttribute("data-button-idx")));
                });
                console.log(el);
            });
        });
        var buttons_by_key = {
            '0': '0',
            '1': '1',
            '2': '2',
            '3': '3',
            '4': '4',
            '5': '5',
            '6': '6',
            '7': '7',
            '8': '8',
            '9': '9',
            'Enter': '+',
            '-': '-',
            '/': '/',
            '=': '=',
            '.': '.',
            'Shift': '*',
            'Backspace': 'CE',
        };

        var buttons_by_key_right = {
            'q': '0',
            'w': '1',
            'e': '2',
            'r': '3',
            't': '4',
            'y': '5',
            'u': '6',
            'i': '7',
            'o': '8',
            'p': '9',
            'a': '+',
            's': '-',
            'd': '*',
            'f': '/',
            'z': '=',
            'x': '.',
            'c': 'CE',
        };
        document.querySelector('.calculators').addEventListener("keydown", (ev) => {
            var button = buttons_by_key[ev.key] || buttons_by_key_right[ev.key];
            var el = (Object.keys(buttons_by_key_right).includes(ev.key) ? document.querySelector('#musical-calculator-right') : document.querySelector('#musical-calculator-left')).getElementsByAttrValue("data-button-key", button)[0];
            if (!(el instanceof HTMLElement)) {
                return;
            }
            el.click();
        });
        cgrcssjs.styleAll();
    </script>
</body>

</html>